--// Kh·ªüi t·∫°o GUI ch√≠nh
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
local MainGui = Instance.new("Frame")
MainGui.Size = UDim2.new(0, 350, 0, 400)
MainGui.Position = UDim2.new(0.5, -175, 0.5, -200)
MainGui.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
MainGui.Visible = false
MainGui.Active = true
MainGui.Draggable = true
MainGui.Parent = ScreenGui

-- Toggle Button
local ToggleButton = Instance.new("TextButton", ScreenGui)
ToggleButton.Size = UDim2.new(0, 100, 0, 30)
ToggleButton.Position = UDim2.new(0, 10, 0, 10)
ToggleButton.Text = "Menu"
ToggleButton.Visible = false
ToggleButton.MouseButton1Click:Connect(function()
    MainGui.Visible = not MainGui.Visible
end)

-- Tabs
local TabFolder = Instance.new("Folder", MainGui)
local Tab1 = Instance.new("Frame", TabFolder)
local Tab2 = Instance.new("Frame", TabFolder)
for _,tab in pairs({Tab1,Tab2}) do
    tab.Size = UDim2.new(1,0,1,0)
    tab.BackgroundTransparency = 1
    tab.Visible = false
end
Tab1.Visible = true

-- N√∫t chuy·ªÉn tab
local Tab1Btn = Instance.new("TextButton", MainGui)
Tab1Btn.Size = UDim2.new(0,80,0,25)
Tab1Btn.Position = UDim2.new(0,10,0,10)
Tab1Btn.Text = "Tab 1"
Tab1Btn.MouseButton1Click:Connect(function()
    Tab1.Visible = true
    Tab2.Visible = false
end)

local Tab2Btn = Instance.new("TextButton", MainGui)
Tab2Btn.Size = UDim2.new(0,80,0,25)
Tab2Btn.Position = UDim2.new(0,100,0,10)
Tab2Btn.Text = "Tab 2"
Tab2Btn.MouseButton1Click:Connect(function()
    Tab1.Visible = false
    Tab2.Visible = true
end)

-- ========== TAB 1 N√öT SCRIPT ==========
local function createButton(parent, text, pos, callback)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(0,200,0,30)
    btn.Position = UDim2.new(0,75,0,pos)
    btn.Text = text
    btn.MouseButton1Click:Connect(callback)
end

createButton(Tab1,"FlyGui",50,function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"))()
end)

createButton(Tab1,"Infinite Jump",90,function()
    local UserInputService = game:GetService("UserInputService")
    UserInputService.JumpRequest:Connect(function()
        game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end)
end)

createButton(Tab1,"Speed",130,function()
    game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 100
end)

createButton(Tab1,"Noclip",170,function()
    local noclip = true
    game:GetService("RunService").Stepped:Connect(function()
        if noclip then
            for _,v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then
                    v.CanCollide = false
                end
            end
        end
    end)
end)

createButton(Tab1,"ESP Toggle",210,function()
    -- ESP Toggle
    local enabled = not _G.ESP
    _G.ESP = enabled
    if enabled then
        for _,plr in pairs(game.Players:GetPlayers()) do
            if plr ~= game.Players.LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                local billboard = Instance.new("BillboardGui", plr.Character.Head)
                billboard.Name = "ESP"
                billboard.Size = UDim2.new(0,200,0,50)
                billboard.AlwaysOnTop = true
                local label = Instance.new("TextLabel", billboard)
                label.Size = UDim2.new(1,0,1,0)
                label.Text = plr.Name
                label.TextColor3 = Color3.new(1,0,0)
                label.BackgroundTransparency = 1
            end
        end
    else
        for _,plr in pairs(game.Players:GetPlayers()) do
            if plr.Character and plr.Character:FindFirstChild("Head") and plr.Character.Head:FindFirstChild("ESP") then
                plr.Character.Head.ESP:Destroy()
            end
        end
    end
end)

-- ========== TAB 2 SCRIPT ==========
createButton(Tab2,"Script Brainrot",50,function()
    -- script v√≠ d·ª•
    print("Brainrot script ch·∫°y!")
end)

createButton(Tab2,"Script Blox Fruit",90,function()
    -- script v√≠ d·ª•
    print("Blox Fruit script ch·∫°y!")
end)

createButton(Tab2,"TP ƒë·∫øn ng∆∞·ªùi ch∆°i",130,function()
    local players = game.Players:GetPlayers()
    for _,plr in pairs(players) do
        if plr ~= game.Players.LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = plr.Character.HumanoidRootPart.CFrame + Vector3.new(0,5,0)
            break
        end
    end
end)

-- ========== H·ªÜ TH·ªêNG KEY ==========
local KeyFrame = Instance.new("Frame", ScreenGui)
KeyFrame.Size = UDim2.new(0,250,0,120)
KeyFrame.Position = UDim2.new(0.5,-125,0.5,-60)
KeyFrame.BackgroundColor3 = Color3.fromRGB(50,50,50)

local KeyBox = Instance.new("TextBox", KeyFrame)
KeyBox.Size = UDim2.new(0,200,0,30)
KeyBox.Position = UDim2.new(0,25,0,20)
KeyBox.PlaceholderText = "Nh·∫≠p key..."

local SubmitBtn = Instance.new("TextButton", KeyFrame)
SubmitBtn.Size = UDim2.new(0,200,0,30)
SubmitBtn.Position = UDim2.new(0,25,0,60)
SubmitBtn.Text = "X√°c nh·∫≠n"

local OpenKeyBtn = Instance.new("TextButton", ScreenGui)
OpenKeyBtn.Size = UDim2.new(0,100,0,30)
OpenKeyBtn.Position = UDim2.new(0,120,0,10)
OpenKeyBtn.Text = "M·ªü b·∫£ng key"

OpenKeyBtn.MouseButton1Click:Connect(function()
    KeyFrame.Visible = true
end)

-- Key logic
local Key1, Key2, Key3 = "abc","abcd","baconpr"
local CurrentKey = Key1
local SaveFile = "saved_key.txt"

-- Auto m·ªü n·∫øu c√≥ key ƒë√£ l∆∞u
if isfile and readfile and isfile(SaveFile) then
    local saved = readfile(SaveFile)
    if saved == Key1 or saved == Key2 or saved == Key3 then
        MainGui.Visible = true
        ToggleButton.Visible = true
        OpenKeyBtn:Destroy()
        KeyFrame.Visible = false
    end
end

SubmitBtn.MouseButton1Click:Connect(function()
    if KeyBox.Text == CurrentKey or KeyBox.Text == Key3 then
        MainGui.Visible = true
        ToggleButton.Visible = true
        KeyFrame.Visible = false
        OpenKeyBtn:Destroy()

        if writefile then
            pcall(function() writefile(SaveFile, KeyBox.Text) end)
        end

        if KeyBox.Text == Key1 then
            CurrentKey = Key2
        elseif KeyBox.Text == Key2 then
            CurrentKey = Key1
        end
    else
        SubmitBtn.Text = "Sai m·∫≠t kh·∫©u!"
        task.wait(1.5)
        SubmitBtn.Text = "X√°c nh·∫≠n"
    end
end)

-- N√∫t X√≥a Key
local ClearKeyBtn = Instance.new("TextButton", MainGui)
ClearKeyBtn.Size = UDim2.new(0,150,0,30)
ClearKeyBtn.Position = UDim2.new(0,10,0,350)
ClearKeyBtn.Text = "üóëÔ∏è X√≥a Key ƒë√£ l∆∞u"
ClearKeyBtn.MouseButton1Click:Connect(function()
    if isfile and delfile and isfile(SaveFile) then
        delfile(SaveFile)
        ClearKeyBtn.Text = "‚úÖ ƒê√£ x√≥a key!"
        task.wait(1.5)
        ClearKeyBtn.Text = "üóëÔ∏è X√≥a Key ƒë√£ l∆∞u"
    else
        ClearKeyBtn.Text = "‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y file!"
        task.wait(1.5)
        ClearKeyBtn.Text = "üóëÔ∏è X√≥a Key ƒë√£ l∆∞u"
    end
end)
